<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <record id="crm_team_view_form" model="ir.ui.view">
      <field name="name">crm.team.form.project</field>
      <field name="model">crm.team</field>
      <field name="inherit_id" ref="sales_team.crm_team_view_form" />
      <field name="arch" type="xml">
        <field name="alias_contact" position="after">
          <field name="project_id" />
        </field>
      </field>
    </record>
    <record id="crm_case_form_view_leads" model="ir.ui.view">
      <field name="name">crm.lead.form.lead</field>
      <field name="model">crm.lead</field>
      <field name="inherit_id" ref="crm.crm_case_form_view_leads" />
      <field name="arch" type="xml">
        <field name="team_id" position="after">
          <field name="project_id" />
        </field>
      </field>
    </record>
    <record id="view_res_partner_search" model="ir.ui.view">
      <field name="name">res.partner.project.search</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="base.view_res_partner_filter" />
      <field name="arch" type="xml">
        <filter name="supplier" position="after">
          <field string="Project" name="project_id" />
        </filter>
      </field>
    </record>
    <record id="view_partner_form" model="ir.ui.view">
      <field name="name">view.res.partner.form.project</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="base.view_partner_form" />
      <field eval="18" name="priority" />
      <field name="arch" type="xml">
        <field name="trust" position="after">
          <field name="project_id" />
        </field>
      </field>
    </record>
    <record id="action_partner_project" model="ir.actions.act_window">
      <field name="name">Customers</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">res.partner</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,kanban,form</field>
      <field name="domain">[('project_id','=',active_id)]</field>
      <field name="search_view_id" ref="base.view_res_partner_filter" />
      <field name="help" type="html">
        <p class="oe_view_nocontent_create">Click to add a contact in your address book.</p>
        <p>
          Odoo helps you easily track all activities related to
          a customer: discussions, history of business opportunities,
          documents, etc.
        </p>
      </field>
    </record>
    <record id="crm_lead_all_leads" model="ir.actions.act_window">
      <field name="name">Leads</field>
      <field name="res_model">crm.lead</field>
      <field name="view_mode">tree,graph,pivot,calendar,form</field>
      <field name="domain">[('project_id','=',active_id)]</field>
      <field name="view_id" ref="crm.crm_case_tree_view_leads" />
      <field name="search_view_id" ref="crm.view_crm_case_leads_filter" />
      <field name="context">
        {
        'default_type':'lead',
        'search_default_type': 'lead',
        'needaction_menu_ref': 'crm.menu_crm_opportunities',
        'search_default_to_process':1,
        }
      </field>
      <field name="help" type="html">
        <p>
          Use leads if you need a qualification step before creating an
          opportunity or a customer. It can be a business card you received,
          a contact form filled in your website, or a file of unqualified
          prospects you import, etc.
        </p>
        <p>
          Once qualified, the lead can be converted into a business
          opportunity and/or a new customer in your address book.
        </p>
      </field>
    </record>
    <record id="edit_project" model="ir.ui.view">
      <field name="name">project.project.form.crm</field>
      <field name="model">project.project</field>
      <field name="inherit_id" ref="project.edit_project" />
      <field name="arch" type="xml">
        <div name="button_box" position="inside">
          <button class="oe_stat_button" type="action" name="%(crm_project.crm_lead_all_leads)d" icon="fa-tasks">
            <field string="Leads" name="lead_count" widget="statinfo" />
          </button>
          <button class="oe_stat_button" type="action" name="%(crm_project.action_partner_project)d" icon="fa-tasks">
            <field string="Partners" name="partner_count" widget="statinfo" />
          </button>
        </div>
      </field>
    </record>
  </data>
</odoo>